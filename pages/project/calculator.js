import Link from "next/link";
import { useState } from "react";

export default function Calculator() {
  const [mixRatio, setMixRatio] = useState({
    cement: 1,
    fine: 2,
    coarse: 4,
  });
  const [moulds, setMoulds] = useState();
  const [from, setFrom] = useState();
  const [to, setTo] = useState();
  const [calculate, setCalculate] = useState();
  const [info, setInfo] = useState();

  // const [percentInterval, setPercentInterval] = useState();

  let ratio = [from];
  let diff = to - from;
  let itr = diff / 0.05 + 1;

  for (let i = 1; i <= itr; i++) {
    let element = Number(from) + Number(0.05) * Number(i);
    let elem = Math.round(element * 100) / 100;
    ratio.push(elem);
  }

  let density = 1050000;
  let sumRatio = mixRatio.cement + mixRatio.fine + mixRatio.coarse;
  let cement = (mixRatio.cement / sumRatio) * 1.54;
  let fine = (mixRatio.fine / sumRatio) * 1.54;
  let coarse = (mixRatio.coarse / sumRatio) * 1.54;
  let volume = moulds * 0.0034;
  let volumeCement = cement * volume;
  let volumeFine = fine * volume;
  let volumeCoarse = coarse * volume;
  let percentReplacement = [10, 20, 30, 40, 50, 60, 70, 80, 90];
  let bagsCement = volumeCement / 0.035;
  let bagsFine = volumeFine / 0.035;
  let bagsCoarse = volumeCoarse / 0.035;

  function Submit() {
    if ((moulds && from && to) == null) {
      setInfo(true);
    } else {
      setCalculate(true);
      setInfo(false);
    }
  }
  // for (let i = 1; i <= 100 / percentInterval; i++) {
  //   percentReplacement.push(i * percentInterval);
  // }
  let display = percentReplacement.map((element) => {
    return (
      <div key={element}>
        <h4>{element} percent replacement of coarse agg.</h4>
        <p>
          volume of coarse agg. = {volumeCoarse} x {(100 - element) / 100} =
          {volumeCoarse * ((100 - element) / 100)}m<sup>3</sup>
        </p>
        <p>
          volume of EPS = {volumeCoarse} x {element / 100} =
          {volumeCoarse * (element / 100)}m<sup>3</sup>
        </p>
      </div>
    );
  });

  let dis = percentReplacement.map((element) => {
    return (
      <div key={element}>
        <p>
          <b> coarse agg after {element} percent replacement</b> ={" "}
          {volumeCoarse * ((100 - element) / 100)}/0.035 ={" "}
          {(volumeCoarse * ((100 - element) / 100)) / 0.035} bags of coarse
          aggregate (gravel)
        </p>
        <p>
          <b> Polystyrene after {element} percent replacement</b> ={" "}
          {volumeCoarse * (element / 100)} x {density} ={" "}
          {volumeCoarse * (element / 100) * density} grams of
          polystyrene/styrofoam
        </p>
      </div>
    );
  });

  let water = ratio.map((element) => {
    return (
      <div key={element}>
        <h4>At {element} W/C ratio</h4>
        <p>water = {element} x cement</p>
        <p>
          water = {element} x {volumeCement}m<sup>3</sup>
        </p>{" "}
        = {element * volumeCement}
        <p>Water in ltr: {element * volumeCement * 1000} litre</p>
      </div>
    );
  });
  return (
    <div className="calc-container">
      <h3>
        For {mixRatio.cement}:{mixRatio.fine}:{mixRatio.coarse} Mix Ratio
      </h3>
      <p>
        1m<sup>3</sup> of wet concrete assuming that total dry volume of
        material required = 1.54m<sup>3</sup>
      </p>
      <p>
        density of polystyrene/styrofoam = 1.05g/cm<sup>3</sup> (105000g/m
        <sup>3</sup>)
      </p>
      <br />
      <p>Enter Number of moulds/pieces</p>
      <input
        placeholder="Example 240 pieces"
        value={moulds}
        onChange={(e) => setMoulds(e.target.value)}
      ></input>

      {/* <br />
      <p>Enter Percentage Replacement interval</p>
      <input
        value={percentInterval}
        placeholder="Example 10 intervals"
        onChange={(e) => setPercentInterval(e.target.value)}
      ></input> */}

      <br />
      <p>Enter W/C ratio</p>

      <input
        placeholder="From example 0.4 W/C"
        value={from}
        onChange={(e) => setFrom(e.target.value)}
      ></input>
      <input
        placeholder="To example 0.9 W/C"
        value={to}
        onChange={(e) => setTo(e.target.value)}
      ></input>

      <button onClick={Submit}>calculate</button>
      {info && <b>fill all input field</b>}
      {calculate && (
        <div className="calc-container">
          <p>
            {mixRatio.cement} + {mixRatio.fine} + {mixRatio.coarse} = {sumRatio}
          </p>
          <p>
            cement: {mixRatio.cement}/{sumRatio} x 1.54 = {cement}m<sup>3</sup>
          </p>
          <p>
            fine agg: {mixRatio.fine}/{sumRatio} x 1.54 = {fine}m<sup>3</sup>
          </p>
          <p>
            coarse agg: {mixRatio.coarse}/{sumRatio} x 1.54 = {coarse}m
            <sup>3</sup>
          </p>

          <h3>
            For batch mix of {moulds} moulds/pieces of 0.0034m<sup>3</sup> cube
            (ie 0.15 x 0.15 x 0.15 = 0.0034m<sup>3</sup>)
          </h3>
          <p>
            Total volume for {moulds} moulds/pieces = {moulds} x 0.0034 ={" "}
            {volume}m<sup>3</sup>
          </p>
          <p>
            Total volume of cement in the {moulds} moulds/pieces = {cement} x
            {volume} = {volumeCement}m<sup>3</sup>
          </p>
          <p>
            Total volume of fine agg in the {moulds} moulds/pieces = {fine} x
            {volume} = {volumeFine}m<sup>3</sup>
          </p>
          <p>
            Total volume of coarse agg in the {moulds} moulds/pieces = {coarse}{" "}
            x{volume}= {volumeCoarse}m<sup>3</sup>
          </p>

          <h3>
            Replacement of coarse aggregate with Expanded Polystyrene concrete
            for
            {moulds} moulds/pieces
          </h3>
          {display}

          <h3>
            Quantity/volume of cement, fine agg., coarse agg. for {moulds} cubes
          </h3>
          <p>
            cement: {volumeCement}/0.035 = {bagsCement} bags of cement
          </p>
          <p>
            fine agg: {volumeFine}/0.035 = {bagsFine} bags of fine aggregate
            (sand)
          </p>
          <p>
            coarse agg before replacement: {volumeCoarse}/0.035 = {bagsCoarse}{" "}
            bags of coarse aggregate (gravel)
          </p>
          {dis}
          <h3>Water Quantity</h3>
          {water}
        </div>
      )}
    </div>
  );
}
